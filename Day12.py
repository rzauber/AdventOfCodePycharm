input = """..?????#?? 4,1
#?..??.???##?.?? 2,1,1,3,1
?#?.#.??#.?#?#????? 1,1,1,9
??#?#?#??????#??? 9,5
.?#??????. 1,3
#??????.??.??? 4,1,1,1
?.????##??.?#???. 2,3
???#????#???.? 4,3,1
???#??..?#?.. 5,1
?.?.???..??.? 1,1,3,1
???????#???? 4,1,2,1
??.??????????#??? 3,2
##???##???????????# 9,1,5
????##???? 1,5
?????.????#?. 3,5
?.??????#???? 1,6
??.#?#??????##?.. 2,4,3
..???#?#???????????. 7,1
?????#???.#??????#? 7,5,2
??#??.??#? 1,2,4
???????#?# 2,5
.#?.????????#??.? 2,4,4
?#?????????#?.?? 8,1,1
??#?#????.????#?? 6,1,1,1,1
??.??##?.????? 1,5,2
???#??#.??????. 4,2,1,4
?#?####...? 6,1
?????.???#?.?. 3,3
??.?#?.?????#?????? 2,8
.???##???? 4,2
.???#??###????.? 3,8
??#??..??#? 4,3
#?.#?..#??## 2,1,1,2
?????#.#???.??#??? 1,1,1,1,4,1
##????.??#?#??#??.? 2,1,8
?.#?#???#. 3,1
???.???????.??? 1,7,1,1
??#?.??#?.? 1,3
???.??.????##???? 1,2,7,1
????#????#??#?? 1,2,6
???..###??????.#? 2,5,1,1
??##??.???.???.?? 4,2,3,1
????#???#.????. 7,1
???.??#??.?#?????? 3,2
.???#.?##..? 4,2
?...???#?#. 4,1
.????#?##????? 7,2
?#???#???##??#??? 1,9,3
#?#?????#?????.?.? 1,1,6,1,1
#????#???#?.???? 7,1,2,1
.????.?#?. 3,2
??..?.??.?.??. 1,1,1
?????#??#.?#. 1,5,1
??#.??#????.? 3,3,1,1
????????????? 2,1
??.???#?#?#????#?? 1,7,1,3
#?##???????????? 1,2,3,1,2
##?##??????.????. 5,1,1,1,1
???#.????? 2,1,2
.????###?.??#?????? 5,1,1
?#.?#???#??##??.?..# 1,1,9,1,1
#??????#???#? 2,6,2
?.?##.?.#? 3,2
.???#????? 4,1,2
?????.?.??. 1,1,1
?????#????#????? 3,1,7
?#?###..#???##?????? 6,1,3,3
?.????##?? 2,2
????#??##???#????? 3,7,1,1
??.#?#.?###??.. 2,1,1,3
?..#?#????? 4,1
?????#??..????##??. 6,7
##???.#??.?? 2,1,1,2
?##?#.?#?#?.?.?. 5,1,1,1,1
.??.?#?.?#? 2,1
?????.????#???#?.?. 1,8,1
#?###????#?.?.. 1,4,1,1,1
.??#???##???#.??# 2,1,3,1,1
.???.?#?#????.? 2,7
.?.??#.??.???????? 1,1,2,1,3,1
#???#??#??? 3,2,3
#?.??.???##?? 2,1,3
.##??????.??????#?.# 2,1,1,4,1,1
???#??#?.??#??#??.#. 5,1,4,1
.??.???????#? 1,1,2,2
??###??.??.?#?? 7,1,4
??.???????? 1,8
??#??##???#.??? 10,2
#.??#???..???#??# 1,1,1,1,5
#?.??#??.?..?? 1,4,1,1
?.??..?#.???#?#?#. 2,1,6
????#?#??#??... 6,3
?#?#?????#?##.?#? 6,2,2,1
?#??.???????????. 3,3,6
.#.??#?#??.?#.?#?. 1,4,1,2,2
???#???.???.?#?#?#?. 4,7
???#?????#?.???.?. 2,3,1,1,1,1
?#?.#??#??? 1,6
??.?????#????.??..? 1,10,1
?.?#?##.??#??.?. 1,4,1,2,1
??.#??.???? 3,1,1
?????##?.###?#???? 5,7
?#?#??.???#??.???.? 5,1,3,1,1
??#???##??##??#. 1,13
?##????.?#???? 4,1,6
.???????????????? 7,6
.?#???#?#??.# 5,1,1
?.??????.?#??.????? 5,3,2
??#???.#??#...?.? 4,4
????.????? 3,3
????#???#??.? 1,1,2,1
??.??????##?#??##.? 1,7,1,3
#???##?..? 1,3
????????#????.#? 1,1,3,3,1
??????????#???#????? 1,2,2,1,1,5
.?.???##????#?????? 1,7,1,1,1
???????.??#??#??? 2,1,2,4
???????#??.??.??#? 1,3,1,1,1,4
???#.????#???#?? 1,1,4,1,1
?????#?##? 1,3
..?#?????#??.??..? 2,2,1
????????????..?? 5,1,1,1
???????##????#? 1,1,5,2
????#????? 1,1,2
?#???#..??.#??.? 4,1,1,1,1
?.?#.?..?#?#?? 1,2,4,1
??#?##??#?##??.??##. 1,12,3
?.??#?#?.?.?????#? 1,6,1,4
??????#?????? 1,1,6,1
???..??#??#?????? 1,9,1
#????#???? 3,1,2
????.?.????.?? 1,1,1
.?##?#?##??###?? 8,5
?#???.?????#??# 3,4,4
??#??#.???#? 6,1,1
#???.?#??##..?? 3,6
??????????#?? 3,2,2
????#?????#?? 1,2,1,2
.?#?#???###?. 5,5
?##??????.?? 5,1,2
????????#?##?##?.# 3,1,1,5,1
???#?????#??#??#??? 4,10
?#?????#????#?##??? 9,6
??.?.????????.#?. 4,1
?#??#????#?#???. 10,2
??.??????? 1,1
.??.????.????..? 3,4
.???..????..???.. 3,2
?.#?????..???#??. 6,1
???.??#?#? 1,5
??????#?#????#.?? 1,7,1,1
#??#?##.??????#??? 2,4,4,3
?.??.#???#?? 1,3,1
??.???????#?? 1,10
???.#?#?..#??#? 1,3,2,1
.?.?##???.? 1,5
??###?#?#?.??#????? 8,7
?#?..???#???? 2,7
?#?##????????? 4,2,3
?.?#?#?????.? 1,3,1
?????.??##??????? 1,1,6,2
?#..#???.?.?#.???? 1,4,1,1,1,1
?#..???.????? 1,3,1,1
?.??#????????? 1,1,3,1
?#?#..?????. 3,2
?#?###?#?#????# 10,2
?.??#.?#??? 2,2
??#?.#?#?..???# 1,1,3,2
?#.????????.??????? 1,3,1,1,1,2
???.????#?.?##??.#. 1,1,2,5,1
??..#???#. 1,1,1
?.????#??????????? 1,2,1,1,1,2
.?#...??##. 1,1,2
?.?????##. 1,2,3
?.#?#?##?#?##.?# 1,4,4,1
?##.?????.? 3,1,1
????#??.?#?.?????? 7,3,3,1
??#?#??.?????.???#? 6,1,2,4
??##???????#?? 6,1,3
..????.????#??#??? 2,7
???????#??.#?#??#. 1,1,1,1,4,1
???#???????? 1,1,2,1
????.?????? 3,2
???#??.???? 4,1
??#.??????.?.????#?. 2,1,2,1,5
????.#?.??..#???? 2,2,2,3
.????.??.?#?##?#? 1,1,2,8
??.?#.?????#?. 2,7
.?#.?##???..?..?? 1,5
????.##?#????. 1,5,2
?.??????###??#??.? 1,1,8,1
???.???...? 1,2,1
.#.????.?.?????? 1,2,3,1
?#?????###??#???. 1,12
?????????.? 4,1
??.?????.????? 1,5,1
.??.??.???? 1,1
.???????.?? 2,1,1
??.##?.??.?#?..??### 2,3,2,5
????#??????#?#??.? 4,8,1,1
????#..????# 1,2,3,1
??##..#?.?#?##. 3,2,2,2
??#####?#????? 7,3
?.?.?##?## 1,5
?..??.??..???#? 2,4
???#???##?????#. 8,2
?#.#????#? 1,1,2
??.?##???.? 1,4,1
?..??#?#??.#???? 7,3
?.??#.???????#??... 1,1,2,7
?#???.????#??..??? 2,2,1,4,1,1
?#?..???.???????? 1,5
??.?#?#??#?#??.?#?. 1,11,3
##???#????.?#???.? 4,1,2,4
.??#?.?????#?. 4,2,2
.##??????????#?..? 2,5
.???.?##?????#??#? 3,7,1,1
?##???#??????? 3,7
?.??.???#?? 1,6
.??.?#????#??#??#? 1,2,9
.????#???##.###?? 9,3
...??#??#???????? 4,1,1,1,2
?????##?##??? 3,6
#?????#???##????. 4,2,4,1
??????.#??#. 1,1,4
##???????#####??.?? 2,8,2
???#??????. 2,3
???#.?#.??#??# 3,1,2,1
???#????.????? 1,2,2,5
??.?.??.??? 1,1,2
.##?#.??#..? 4,2,1
.??????.??###? 1,6
???????##.???. 6,2,2
?????????.? 1,2
?##?????.?? 6,1
?????.???.?. 1,3
.?#??.??.???##.?. 3,1,1,2,1
????.??#??.?#??? 1,1,4,1,1
.??#???.#??.????? 1,2,3
?????????#?????.?# 1,6,2,1
?#???..??????### 5,1,6
????..??## 1,2,3
?#??.?##??#?#?. 2,8
?#?????#?.????? 6,2,1,1
#.#.???#??#. 1,1,4,2
#####?#?##?#?#??#??. 5,8,1
?????????#???##???? 1,1,3,1,4,1
????.????#?##???.? 1,8
.?##???????? 3,2
#??.?..#????.? 1,1,1,3
?.??#?????????# 1,1,2,1,5
.#??????????.????. 5,3,4
.??.#?.????????????? 1,1,1,5,1,1
?#?#.?????. 1,1,5
#?????#??#?##????# 1,4,4,1,1
????..?#??? 3,1
.?#.?.???? 1,1
??.????.??? 2,3,1
?##????#??#??????.?? 3,6,1,2,1
?.?#?.#?#?#??#??? 2,11
??.#?.#???#???? 1,1,8
?#???.#??#? 2,1,1
????#?.??###. 1,1,5
#?????#??..??????? 1,6,6
??????#??#??.??#.? 8,1
??????#??????? 10,1
??.????????#?? 2,2,1
?#?.?#?.?##?# 2,1,5
#??????.#.?????? 4,2,1,1,2
?.????????#??????? 2,9,1
?..##???.??###? 4,5
.???#??.##?# 3,4
?#..?##?.?..? 1,4
#?????.?.??# 1,4,1
.??.???#??#??? 1,5,1,1
????#??..?.#??#? 1,4,1,1,1
.?#??#?##.#?.???? 1,2,2,2,2
.?#?.?##????# 3,4,3
.?#???#.#???.??#? 5,1,3
.#.?#??.#. 1,2,1
??#?????.? 6,1
??.??#?????#???? 1,6,3
?#?#.?.??#??#.?? 4,3,2,1
...?#????. 2,1
?.#?.???#?#??? 1,1,8
.??##?#???#??.##. 1,6,1,1,2
???#?##???.##??.? 2,2,2,4
???????##??? 4,4
.#??????.? 6,1
?.?#?????.?.?? 6,1
???#????#?? 4,4
#??###.#.?? 6,1,1
??.??.??.#?#? 2,1,1,1
?#???????.????.#? 8,1,1,1
.#?.??.?#?.?. 1,2,2
.??#????#??#?. 2,2,3
?#.?#??..???.#??. 1,2,2,3
????.???#??...?? 1,1,3,2
?..?????.???? 1,2,1
.??????????????. 2,6
???.?###??#?##.?. 1,1,10
.??#????.?##.?. 4,3
##?..?.??????? 3,1,3,1
???????#??.?????#?? 1,7,2,1
??.?.?#?#??# 1,1,3,1
.?#.?.?..?##?#??.? 1,1,4
?.?#????#. 2,2,1
??????.#?? 1,1,1
????#..????????## 2,1,1,5,2
???.?.???#?#???# 2,1,6,2
??#??...???? 4,1,1
?#?.?????# 2,2,3
.??.?????.. 2,2
???????????????? 5,1
.?.?#?????#???# 1,2,1,2,3
.??.#.???#?.??? 1,1,2,2,1
??#????????.??.????? 1,7,1,3
??#?????#??. 5,2
????..??.#????? 1,2,2,6
??#.?????## 1,6
#?##?#?????? 8,1
.?#??#????#? 2,1,2
#?#???.??# 5,1
?????????#???#??.?? 2,9,1
?????.#?.??????? 5,1,1,1,1
.?#???????. 1,6
??.??.?.??? 1,2,1
.??..?##?.??..### 1,3,1,3
?????#?#???.?.?. 8,1,1
..#???.???? 3,3
?#??#?#??##? 2,2,1,3
???????#??..?. 1,6,1
???##???????# 6,1,2
??#??.?#?.????##??? 1,1,1,1,3,5
?..?#..??##??#? 1,2,8
??????#..???????. 1,4,3,1,1
??#?.?????. 2,5
???#.????#???#???? 1,1,1,7,1
??#??#???.#?????? 3,1,1,1,2
?#?????.?.#? 4,1,1
#??#?#??#?.#. 1,7,1
??..#?#?..??? 3,1
.????#??#?#??.???. 11,1
???##????#.??#.??? 1,7,3
?#??#????????#.??? 1,2,1,1,1,3
????#??#?# 3,1,3
?.?#?###???.??? 2,5,2
?#?#???????? 4,1
#?#???????#? 1,4,1,2
???#?.#?????# 1,2,4,2
.##????????#?#?. 3,1,1,3
#??????.?? 5,1,1
?##.????.???# 3,1,1,1
???.??###???#??#???? 3,10,4
?????##.?#?#?#??.?. 2,3,7,1
??.????????##??.?.?? 1,11,1,1
?.?????#??????? 1,1
????##??????#?????#. 1,14,1
##???.???#?#?? 3,4
?#??##..???#? 3,2,1
????.??.???? 1,2,1,1
???###?????.?.??? 1,8,2
#?#?#???..#.??????? 5,1,1,1,1,1
??????????.??? 5,4,2
?..????.##???? 1,2
???????#???? 2,2,1,2
???#.???#???.?. 3,1,2,1
???#????#?? 4,4
?.????.?#?#? 2,3
????????#.?#??..?# 1,4,1,1,2
.#?.???.????#?.??? 2,3,1,2,1
?????????.?#?#??.? 1,4,3,1,1
????#?#????#??? 1,2,1,5
.?.#?.#??.##? 1,2,3,2
?.??##????.??#??#??. 8,6
???#?#??????#??#?# 8,3,4
??.??????# 1,6
?..????#????##?.#??? 1,1,9,4
..??##.?##??? 3,6
?????####??.??#. 1,1,6,1,1
#??#.#???? 4,1,1
#?????.???. 2,2,2
.?.##???.??# 3,2
?#??????.? 3,2
???#??.??? 1,1,2
??.??#???.???? 1,4,1,1
???###?.#?.?? 4,1
?????#????## 1,1,1,2
..?#?????#? 2,4
#??#???#??..????? 1,6,1,1,1
??#???.?.? 3,1
?????.???? 2,1,1
????..?????? 1,4
.??????#????.##?## 8,5
??????#??# 4,1,1
?.????.?#??##?## 2,9
?#???#??.#?????????? 8,1,1,1,1,1
??????.????#?? 3,2,2
?###...?#??#.? 3,4
?????.?#.? 1,1,1
?????.?????????#???? 4,1,1,1,1,2
?????#?.????? 7,4
????#.???#.??### 3,2,4
.??##???????????.? 1,6,1,1,1,1
?.#??..?#????.# 2,5,1
.?.?.?#.???#?#. 1,1,1,3,1
??????????????#? 2,5,4
#.?#.??.??### 1,1,2,5
??#???.??? 1,3,1
.?###?#?.?.?.##???#? 3,1,6
??????#?#???#.? 2,5,1,1
????###?.?#???.?#?? 8,1,2,1
.?.?#?#??.#??.??? 4,1,2
???????#??? 2,7
#??#?#???? 7,1
?.???.??.. 1,2,1
.????###?????????. 7,1,1,2
#???.??#.?#? 1,2,2,3
##??.???.????##.?#?? 4,1,1,1,3,3
.#??????#?##???? 1,1,4,2,1
???????##??#?.??.? 2,1,3,2,2,1
?????###???..??. 7,2
#???#.????###.???? 2,1,7,2,1
???.?.?????#..#? 1,1,1,3,1
#?????#?????#????? 1,1,4,2,2
????????.??##..? 1,3,2,3,1
?.??#?#?#??##??#?#. 1,6,3,1,1
?.?#?#??.##? 3,1,2
??#???##.?? 1,2,2
?????#??##????? 1,9
???###?#????.?##?#. 1,10,4
.?..?#??#??.#??? 1,6,1,1
?...?#.??? 1,1,1
.#??#???###????#?#. 1,7,1,3
?#???????# 2,2,3
.???#?..#????# 3,1,4
????????????#.? 1,2,5
.?#????##. 2,2
#???#..#????#??? 5,3,2
.#???#???###?##?# 1,12
????????#?# 4,4
#????#?.????#.?# 4,2,5,1
?###?.#????#????# 5,8,1
#?#?#??#???? 1,3,1,1
??.?#?.?#?????#???? 2,3,4,1,2,1
#???..???.#???## 2,1,1,1,6
?.?..#.???##???? 1,1,1,5,1
?.#.??.#.# 1,1,1
.?.???###?#?? 1,8
?????????#.?????? 8,2
.#?.??##.????.?? 1,4,3,1
.????###..?.#? 7,1
#?##??.????. 6,4
??#????#.?#????.??#. 6,1,1,1,1,1
????#?.??#???.??? 2,3,5,1
?????...?. 5,1
?????#?.??????.# 2,1,2,1
.#?#????#??.???????? 1,1,4,1,3,1
?????..?.???. 1,1,1,3
?????????.?.???#. 7,3
???????.#? 6,2
#??##?????.?.?.??# 2,5,1,1,2
??#?#?????? 4,1
?????.#..#. 4,1,1
???????#?...?.?# 1,5,1,1
..????#??? 5,1
#?#???#?#??.?? 1,5,3,1
?.#???#??#??###?##?# 1,2,2,2,8
?????????.#???? 4,1,1,1,1
.??????????#?#??? 1,3,5,2
.??..#????#???#. 1,1,2,5
?????#??####????? 3,9
?????????##????? 2,10
?#?.##????.#????#? 1,2,2,4,2
?#?..??.?#?#.. 3,1,3
???###.##????? 1,3,4,1
?#.?.?#?##???#??? 1,1,8
?.??#.?.?.????????? 2,2
??#??##??.???## 2,3,1,1,3
????#???##????? 10,3
?.#?.?.????#?..?.#?. 1,1,1,6,1,1
???.?##?????.???#?# 1,1,4,1,1,3
??#?????????? 2,4,3
???????#???????#?#?# 1,1,3,7,1,1
??????...?#??.?. 5,3,1
?#?????????.???### 2,3,1,5
...?..?..#?#?.? 1,1,4
?.#?.?????..? 1,1,1,1
?#.?.????#.????????? 1,1,1,3,6,2
????#?##.?.??..? 1,5,1,2
.???#??.?#??????? 4,4
?#????#??.?? 4,1,1
?.??.?.##? 1,3
??#??#???.?????##. 7,6
??##.#?#?#?#. 4,7
??##??#?..?#?.#?? 5,2,1
?#??.??#??.????.??#? 4,1,1,1,1,4
???#?.??????????. 5,10
???##??#??##? 4,5
.???.???.?# 1,3,2
?????#???#????.?? 3,2,1,1,1
?.??##??????.?.??#? 1,7,1,1,1,1
???#??##?#???.?? 9,1
???#????##??#???##?# 1,3,6,2,1
???#?#?#????.?..?### 10,4
??##???#??????## 2,2,1,2,2
#?.#?????..?? 1,4,1
??#?..###???#?#. 3,7,1
?.#???###???..?? 1,2,6,1
??##.???#?????#???? 4,1,11
?????#??????.?##?. 4,2,1,1,3
#??#??.????? 1,1,1,1
.??#??.??#?????? 3,1,7
.##??.#?.??.????? 4,2,1,1,1
?#.???.?#?? 2,3,1
?.??#?????.? 3,3
??#??#?##??# 2,8
.?.##??###??????.?? 1,7,2,1,1
.#????????????##?#?? 3,13
.??..???##???????#.. 2,1,8,1
??????????? 3,2
????#?.????#.#??? 1,1,5,2
?????.????????. 1,1
?#??????.? 2,1
???#?##??#? 7,1
#??????#.??#??.?.#? 1,5,2,1,1
??#???????.??? 5,1,1
?????#?????.????? 9,1,2
##????####.??? 10,2
?.#..??????#?? 1,6
.#??#??##?????? 1,6,1
..?#?.???#?????? 3,1,3,1,1
??.#??.?????? 2,1,1,5
?#?#????#?..#????? 9,1,4
...????###?..???.?? 7,1
?#?.??#???#??????? 1,9
###??##?.?..??? 8,1
.##?.????? 3,1,1
.#????.??##?? 3,1,4
.??.#.?.??. 2,1,1
.???.?#???#? 3,2,4
??..??#?????.?#??.. 6,1
#??#.#.?????#?# 4,1,1,5
.#?????##?. 1,1,3
#????#.??.?.?????? 3,1,1,1,1,2
?.?????.#?#?.?. 1,3,1,2
??????.?#?#? 2,1,1,1
.??????#.?#.???? 6,1,1
?.??#?...??????.? 3,5
?#?##????????##??. 9,1,2,1
#?????????.? 1,1,1,1
.????.?????# 1,1,2,1
?#?#.???????.. 4,6
.????#..?##??? 3,4
?.??#?#???????????? 1,1,1,5,1,1
??#.?????..?#.#?? 3,3,1,2
??##..?.????? 4,2
????????????? 4,3,1,1
?##???????##???##?#? 6,1,10
?????.??#?#??? 3,5
#..??..#.? 1,1,1
???..??#???.?## 2,2,1,3
?????.#??????? 2,4,1
#.?????????#??# 1,2,2,2
.????????.?.?.??##. 6,2
??????.???. 1,2
?.?????#???.? 5,1
..??..??#???? 1,4
??##???..?.??? 6,1
?????.?#??#???##. 2,5,3
??.??????????????? 3,8
?#.?#??#?? 2,5
..???.???#? 3,1,1
...?#.??.? 2,2
?###?#?.?#.?.??#???? 6,2,1,1,2
.?#?.???#???.?##???? 2,4,1,3,1
?#??#??###?.?..???# 6,4,1,4
?##?#????#??.?.? 9,1,1,1
#???#?.#.#.?#.??.?? 5,1,1,1,1,1
?#??#???.### 1,4,3
??.??????#??#????# 1,2,1,5,1,1
?.?#?#??###.??# 9,2
??##?????#.?? 9,2
??.??????#?. 1,3,1
.?#?.??????? 1,2,1,1
?.?#?.?.?.##.??? 2,2
#?#???.????#.? 5,4
?????.????#? 3,1,1
?.??#???#??..???? 8,1
?..???.??????#????? 1,2,4
?.??.?#??????#???##? 2,1,3
..?..??????.???# 3,1,4
????.#?#?? 1,1,1
?#??.?????? 1,1,3
?#?.??..?#????#????? 2,10
..#??#??##??#???. 1,6,4
.#????##??#??? 1,9
.?.???.??????#? 1,1,6
???????????.?##.??? 6,1,3,2
?#?#???.????????#?#. 1,3,1,1,6
??##?.???#?.????#..? 3,5,4,1
??#??.?#??????#??# 1,1,1,1,1,7
#???.?#????#?..#?# 4,8,1,1
???#?#???#.???##.# 5,1,1,2,1
??????.??????.??. 3,5,1
????#????.#???? 4,1
?.##?##.???#?#?? 5,6
?????#?.???? 1,1,3,2
.?????#?#? 1,5
????#???###.??##.? 10,2,1
??#?##.??#???.????# 2,2,1,4,1,1
?#???.#####??? 1,1,5,1
????..???. 2,2
?.????#??# 2,2,1
????#???#????.?#. 6,1
?.???????? 1,1,2
?##???????????..??? 6,3
.???#??#???#??#?.## 6,4,2
?????#????#?#?#??? 6,9
?#..????#?#? 1,2,3
?.????????? 1,2
??#..?#?##.??#?.? 3,2,2,1,1
#??.???#?.????? 2,1,2,3
??#???.??.?.??? 3,1,1,1,1
???????.#??? 4,1,1,2
???????#?????#. 4,4,2
.#??#?.#.??? 1,1,1,2
?#???..????.?.?#?? 2,4,2
##???????##?# 2,3,5
???#?????? 1,2
?#.##???#???#????? 1,3,1,4,1
???...??##?#? 2,4,1
?.?##???#.?? 3,2,1
?????#.??? 2,1
#?#???#????#???#.?## 1,1,12,2
???.??#?????????#### 2,6,7
.?..??###?#??.?. 1,1,6,1
.?.???.????#??# 1,7
#?##??????? 1,5
...##.?#??????? 2,7
???????###?.??#????. 11,6
?????#?##???????? 4,9
#?#??????#..?#?.#?? 10,2,2
?.##????##?#??????.? 2,8
#?#...#.?#????###?? 3,1,1,1,4
?#.?#????.?? 2,2,1,1
?.??#?##??? 6,1
.??#????..? 6,1
?.?##.???????#.? 2,1
??#???????#.? 2,4,1
??#??###..?..?? 6,1,1
??????????#.? 3,3
?????##??????. 8,1
#?##???#????# 1,4,3,1
.????????????#?????? 4,8
?#?????????? 1,3,1,1
.?#?.#???.??? 3,1,2,1
#????#??.????????? 1,1,3,1,3,1
??#???.?##? 5,3
??##?#????##?###?? 5,6
???????##????#..?. 1,3,4,1,1,1
?##??#???.?#?? 3,1,1,2
?.???#?#???#?.????? 10,1,1
?#????..???????#??## 2,1,12
?.????#?#? 1,6
????#??#.#???..#???? 3,1,1,1,2,2
?#??????.???#?.? 1,4,1,1,1
?.#???##???????#. 1,2,2,7
....????????????? 3,5
??.?#?##????????.??? 1,2,4,1,1,2
??#?.##?#.?.? 2,4,1
?????#.??#?? 1,3,3
???#.??##?? 1,1,3
?.?????##?? 1,1,6
???#???#?# 3,1,1
???????####????##? 4,12
??#?.??.#.??##???.. 1,1,1,1,6
.?..?.####??. 1,6
?#.???????? 1,2,2
.??.????.#?.. 1,1,1,2
???#?????. 2,1
.??#?#?.??#? 3,1,1
?????????#. 1,2
????.#?#????????? 1,1,1,8
??.??????#??..#????? 7,2
???#??##???# 2,1,4,1
?#?.?..???#??##?#??? 2,11
?.???#?#?? 1,3,1
#?#?#??.#?.?.??.?#?? 1,1,3,2,1,2
?.??????#??? 2,1,4
???.#?#??? 1,1,2
??#????.??.???? 2,1,1,3
???.???#?????? 1,1,7
?????.?.?.## 1,1,2
.?##.#?????????#? 3,5,1
.???.????? 3,3
??#????.?????? 3,1,1,2
???#?####?#?#??#?.# 13,1
???#??#??#?.#?? 1,1,1,2,2
.?.?.??.?? 1,1,1
?.?.?#####???##?? 1,12
##.???##?.?#?##??#? 2,1,2,8
????.?#??#??.#?? 4,2,3,1
###.???.?.?# 3,2,2
.????#.???#??..?. 2,1
????????.?#?.? 1,4,2
?#??#??????? 5,4
#???#.????##????##?? 2,1,14
??????.????#?. 2,1,1,4
????..#..?? 2,1
.????..#???#? 1,6
??#????????#????..?? 1,1,10,1
??#..???.?? 1,3,1
??.?????.?#?#?. 1,3,5
?#???#???#?.. 7,3
?#?####???#???.?# 1,8,1,2
????#?#.#??#???#?.?? 1,1,1,5,2,1
????####???# 1,5,2
?.???#???? 3,1,1
?#?#??#???#??? 4,3,2
????#???#.??#???#??# 1,1,5,4,2,1
#?.##.??????#.?????. 1,2,1,4,3
#??????????#####??.? 1,1,3,7,1
.##???##??.?. 2,5
.???#####?? 1,5,1
??#.????#?????? 3,9
.????.??.???.?. 3,1,3
?.#..????#?##????#? 1,1,6,2
.?#?#.#?###????#. 1,1,8,1
???????#?.? 2,3
????.????###?#??? 1,1,2,6,1
????#???.???.???. 5,2
?#.???#..??#? 1,3,2
??.?##????? 1,3,1
?.?.??#?#?###? 1,7
?.?..##?#?????? 1,1,5,1
?#.??.????#.?.#???#? 1,1,5,6
???##??????? 1,3,1,1
??#???????#??? 1,4,4
????.?????#??? 3,7
?#.#????#?.?#. 2,2,3,2
#??#?.#????? 5,2,2
?.#???????#?.?? 1,10
???#??????#?.?????? 4,3
????.?#?#?????????# 1,1,6,5,1
?#???#????#?#? 2,4,1,1
?#.?????#????#???? 1,15
?????#???.? 3,1
????#?#??????? 7,5
?.?.?.?#.??.?#???. 1,1,1,1,1,5
.????#?#?????#?? 1,7
???#?##??#????.?? 7,1,1,1
???#???????.?.? 4,3,1,1
????????##??? 1,8
#?????##???.???### 5,2,1,2,3
??#?????.? 2,1
#???#?##?#?#????.? 3,4,1,1,2,1
##?.???###????#?? 3,2,3,4
#?#?#????#???.#?? 1,10,1
?.#????#?.?#??? 6,2
.?.???????#..????? 1,3,2,2
?.????##?#????? 1,7
??#??..?###?????# 2,4,4
???#???..#?##?.?. 3,4
##???#.???..???. 4,1,1,1,1
?????##??#?????? 1,11
#??.??#???? 1,4,1
?.???#?####?#??????. 1,7,6
??#.????### 1,1,6
.???#????.???#? 2,4,1,2
?#??..?#???##?#??.# 3,1,3,1,1,1
.??#?#???????? 3,4
.??#?#?#?????? 7,1,1
??##?.?..#??????. 2,1,4,2
?#???#..????#?.?? 6,2,2,1
??#??#??????# 5,1,1
.??????###??#?????. 1,1,10
???????###.#????.? 8,4,1
??#???.#?#.#?? 3,3,3
??#..?#?????#??? 1,2,7
.??#???.?#??? 3,1,1,1
??#????????#?? 6,1,2
????#???##?.??#? 1,7,1
.??.?.???#??####? 1,1,10
.????..?##?#? 4,5
??????.??#.? 1,1,3
??.??#.???????? 1,1,2,1,1
???#??...?????. 1,3,1,2
##??##????#?????? 2,4,4,1
?#??????..?. 3,1
?######??.??.#????. 8,1,3,1
#???.???????#.??? 4,1,3,1,1
?#????#?#???#? 2,2,1,2
???.?????? 1,1,1
.?##?#????#?.? 6,2
????#???#?##..???#? 1,5,1,2,1,3
???#.??#???????. 1,1,3,2,1
??..?.??#?.??????. 1,1,4,1,2
?#???????##??##???#? 4,1,12
...##???#?.???#. 7,1
?#.????????????. 2,1,3,1
??#?????..?##?? 1,2,3
#????#?#?.???#?? 8,1,2,1
.????????#????.??#?? 7,4
???#?##?????# 1,6,3
??#..#.??#??..? 3,1,5,1
????###???#??.??? 6,2,2
?.?????##????# 1,1,1,7
????.??.??#????? 4,6
.?##?????#...??? 9,1
??.??##?.?#?? 1,3,1,1
?#..?????? 1,2
?##?????#? 5,1
.####?.???? 4,2
????#?.#.?????? 5,1,1
???#???.#??????#?#?? 1,3,2,6
.?..????.?????# 1,2,1,2
?#??.#?#?#?? 1,1,1,4
?#????#?????? 4,2,1,2
??#?#??#?#?# 2,1,6
#??.#.#????..?#?? 1,1,5,2,1
?.??##????? 1,4,1
??????#????????#??? 2,1,6,1,1,2
??????#.????????#? 2,1,1,1,3,1
??????.???? 1,2,4
??##?#????????????.? 4,1,3,1,2,1
##??#??????????# 6,2,2,2
..???..??. 3,1
##?#?#?#??.#.????? 10,1,1
#???.???.#??????. 3,2,4,1
#.?.?#??????????.? 1,1,5,1,2,1
??#??#?????#.?.? 6,1,2,1
.#?.????????#? 2,4,4
.#?#?????.??. 4,2
?.#????.?.? 1,1,1
.?#??.??.??? 2,1,2
.??#.?????.. 1,1,1,1
?????#?#?#?##?? 2,3,1,4
??#??#?.#??#?#? 2,3,4,1
???????#????##?#?#. 4,1,1,8
???#????#??.#. 4,2,1,1
??#???.???. 3,2,1
????????????#?? 1,1,1,1,4
??#?#???.?.?.?? 1,1,4,1,1
.?????.??.##?#??#?. 3,8
?.???.???. 2,3
?#???#?.???#??.#... 6,6,1
.#.???#?##?## 1,4,2
.????.??#?????# 4,8
#??#???.??#?#? 2,1,1,6
?..????#????????# 1,1,6,1
?.??#??.???#?????#.. 1,5,4,1,3
..??????.????#??#. 4,7
.???.??????. 2,4
???#..??#???? 4,6
?##.?.?#??#???? 3,1,1,2,3
?.##?????.?? 1,3,2,1
.??.???#?.???..?? 2,5,2,2
#???????.?? 8,1
.??##?.???? 2,1
????####?#??.???#??? 1,4,1,1,4
??#..??????#? 1,1,2,2
?.?###?#?? 6,1
.#??????#???.?.? 4,1,1,1,1
?..#??????.#? 1,1,4,1
.?????????.? 4,1
???.??.?#??????? 3,1,1,3,1
?#??#??#???. 2,5,1
..???##???????? 8,2
??#?.#?????#??.# 1,4,2,1,1
#.#.#.??#?##??#? 1,1,1,4,2
.??#??#??? 1,1,2
#??#??..?#.????. 2,3,2,1,1
???.????#? 1,1,1
.?.?#???????? 1,7
??#.?????#?? 1,8
??.?????????#?? 1,1,8,1
?#??#??.?#?#?#???# 1,2,1,1,5,1
?#???#??#?#????.? 2,3,1,5,1
?????#.???# 2,2,3
.?.????????#??#? 1,4,4
?????#?????#??#??.# 16,1
?#???#???? 2,2,1
##?#???????##..??? 13,1,1
#?##?#??????????..? 6,1,1,1,1,1
?????.#?.??????#?#?? 1,2,2,1,1,7
?.?#???#??????.? 6,4
#.###??????.? 1,3,1,1
????#??#..?#?#??? 6,5
?#????.??# 3,1,3
.?????.??#????#??? 3,1,3,3
#????.?#??#. 4,2,2
?????##.##??.?? 6,4,1
#???????#????#????? 1,1,2,4,1,1
..???##?#?????##???? 1,15
?#..?#??.??.?..??# 2,4,1,1,1
.????.?.?##? 2,1,3
?.????????#? 1,1,1,1
.?.??#?#?????.???? 1,7,1,1
#.???.???##?# 1,2,7
#.?#???????? 1,2,2,1
??..#????????# 2,4,3
?#?#?????..?#??. 5,3,3
?.???????.????? 5,3
.???.?#?#??#?#?###?? 2,1,1,4,3
#???.????#??? 1,1,1,2
?????.???#? 1,3
?????##????##????#?. 6,8
#?.??###??.#??. 2,5,3
?..?????????# 1,8,1
??##?#?#??????? 8,1,3
???.????#??.??? 1,2,3,2
?#?#.??...???#? 1,1,1,1,2
??#..#???.?????#? 1,4,4,1
???#?????#??.??? 7,2,3
??#????#???#.? 1,1,7,1
?#?#??????.????? 7,2
??????????. 2,1
?.??.???.??#.??#? 1,1,2,3,2
?#??.#.?#???#?.? 3,1,2,4,1
?#?#??#??.??? 7,1
##??##???.#???#? 2,5,1,1
.????????? 2,1
???#??#????????.?. 1,1,4,1,2,1
????????#?...????.? 3,3
?..??.#??.?????.?#? 1,1,1,1,5,3
??#???#?#???????#? 3,11
#???????#?###????.?? 6,9
???.#???.?#??? 1,4,4
.????????.###??##?? 1,1,3,9
?#?.??.?..??.#?? 2,2,1,2,2
#?###?????##?.#. 7,3,1
???.#?.?##?#?.???#?? 1,1,1,5,1,1
..?#????#?#?##?????? 3,11
?.???#????..????#?? 1,7,5
??..???#??#?#? 1,1,4,1
???#?.?#?#???#.??## 1,2,2,5,4
#??.??.?.??#.?#?.? 2,2,1,2,1,1
??#?#?#..????. 5,3
?#???##??##.? 2,8
??#?.#????? 2,1,1
?#????.?????#???? 3,2,3
??.??##???.#???. 2,4,3
???###????.???#?.#? 1,5,1,4,2
??#?.?????. 3,1
???.??.???? 3,2
.?##???#??##??..?. 7,5,1
????????#?.? 1,6
#??#.?#?#??? 1,1,6
.????##??.#?# 6,3
#???#?#??#???..?.#?. 1,10,1,2
..???????###??#? 1,1,1,3,3
????#???.?? 7,1
.??????.???####????? 1,1,1,1,7
?????????# 1,4,1
???.??????#??.??.??? 3,7,1,1,2
.???#?##?.#?????#?? 7,9
#????????#?.??##. 6,4,3
.???.?????? 3,4
.????##?##????#? 1,9,2
??##???..#?#?#????. 6,9
???#.???##??? 3,6,1
#..???????????#??# 1,1,5,6
????.?#??#?.?? 1,5,1
#???##???.????????? 8,2,2
???#.##.?##??##????? 1,1,2,7,1,1
?..???#?#??.?#? 5,2
????..???#. 1,4
#??????.??..??..??? 7,1,1,1,1
???#.?.???.??? 2,1,3,2
?????#???#??#.? 6,4
#??#?.?#??#??#? 4,1,2,2
##?.???????# 2,1,1,1
##?#?.???#???#?????# 4,1,3,3,2,1
????#??.#??#??###?? 1,1,1,1,1,6
?????#???? 1,1,5
?.?###??#??.?????. 9,3,1
?.#???.#?????????? 1,1,4,1,1,1
.#####????.?? 5,1
...#...?..?. 1,1
?????.#.??#.?## 4,1,1,1,3
#..??#??#.??.?? 1,3,1,1,2
??.?.?#????.??#?? 1,1,2,1,3
??.??.??.??..#? 1,1,2,2,2
?#???##?#?# 1,6
???##???.#??#?# 6,1,1,1,1
#.???.#?##..?? 1,1,4,1
#????##???##?##?#. 1,4,7
?#??????#?.?.#?#??? 6,2,1,4,1
..#?#???.?..# 1,2,1,1
????##???.?????.. 4,2,1
.?#???#??.? 1,1
.#?#?????.? 1,1,2
#????#?.#?.??#? 1,2,1,2,1
#.?#.?#????.#?# 1,2,5,1,1
?#?.?.#?#?#?? 2,6
#..?.#???#??.#. 1,1,3,1,1
#?...??#????#??????# 2,10,1,1
.??..?##.??? 2,2,1
.#??..??????????#??? 3,2,6,1,2"""

example_input = """#.#.### 1,1,3
.#...#....###. 1,1,3
.#.###.#.###### 1,3,1,6
####.#...#... 4,1,1
#....######..#####. 1,6,5
.###.##....# 3,2,1"""

example_input_2 = """???.### 1,1,3
.??..??...?##. 1,1,3
?#?#?#?#?#?#?#? 1,3,1,6
????.#...#... 4,1,1
????.######..#####. 1,6,5
?###???????? 3,2,1"""

example_input_specific = """??#?#?#??????#??? 9,5
.?#??????. 1,3"""

current_input_lines = input.splitlines()


class Row:
  def __init__(self, str, expandFactor=1):
    multiplier = expandFactor - 1
    sp = str.split(' ')
    #print(sp)
    self.springString = sp[0] + ('?'+sp[0])*multiplier
    self.damagedArrangements = [eval(i) for i in (sp[1]+ (','+sp[1])*multiplier).split(',')]
    self.enoughSpacesCache = {}
  
  def __str__(self):
    return self.springString + '\t' + str(self.damagedArrangements)

  def hasHashInPreviousSpace(self, index):
    if index == 0:
      return False
    else:
      return self.springString[index - 1] == '#' 
  
  #def hasPreviousHash(self, index): 
  #  return self.springString.find('#', 0, index) != -1 

  #def hasRemainingHash(self, index):
  #  return self.springString.find('#', index) != -1
  
  def isUsingAllHashes(self, combination): 
    for i, char in enumerate(self.springString):
      if char == '#':
        isIn = False
        for (combIndex, combLength) in combination:
          isIn |= combIndex <= i < combIndex + combLength
        if not isIn:
          return False
    return True


  def areThereEnoughSpacesForDamagedAtBeginningSuperCached(self, startingIndex, requiredDamageLength): 
    if startingIndex in self.enoughSpacesCache: 
      return requiredDamageLength in self.enoughSpacesCache[startingIndex]

    #print('areThereEnoughSpacesForDamagedAtBeginning(' + str(startingIndex) + ',' + str(requiredDamageLength) + ')')
    lengthAvailable = 0
    allPossible = set()
    if not self.hasHashInPreviousSpace(startingIndex): # Can't start counting from a middle hash
      for i,char in enumerate(self.springString[startingIndex:]):
        currentIndex = startingIndex + i

        if char == '.':
          break
        if char in ['#', '?']: 
          lengthAvailable += 1
          if currentIndex < len(self.springString) - 1 and self.springString[currentIndex+1] == '#':
            continue
          allPossible.add(lengthAvailable)
    self.enoughSpacesCache[startingIndex] = allPossible
    return requiredDamageLength in self.enoughSpacesCache[startingIndex]

  def areThereEnoughSpacesForDamagedAtBeginning(self, startingIndex, requiredDamageLength): 
    #print('areThereEnoughSpacesForDamagedAtBeginning(' + str(startingIndex) + ',' + str(requiredDamageLength) + ')')
    if self.hasHashInPreviousSpace(startingIndex): # Can't start counting from a middle hash
      return False
      
    lengthAvailable = 0
    for i,char in enumerate(self.springString[startingIndex:]):
      currentIndex = startingIndex + i
      if char == '.':
        break
      if char in ['#', '?']: 
        lengthAvailable += 1
        if lengthAvailable == requiredDamageLength:
          if currentIndex == len(self.springString) - 1:
            return True
          if self.springString[currentIndex+1] == '#':
            return False
          return True
    return False

  def determineCombinations(self, combinations, currentCombination, startingIndex, damagedArrangements, totalRemainingLengthRequired): 
    if len(damagedArrangements) == 0:
      if self.isUsingAllHashes(currentCombination):
        return combinations.append(currentCombination)
      else:
        return combinations

    
    for i, char in enumerate(self.springString[startingIndex:]):
      currentIndex = startingIndex + i
      #print(startingIndex)
      #print(i)
      if char == '.':
        continue
      if char in ['#','?']:
        if self.areThereEnoughSpacesForDamagedAtBeginning(currentIndex, damagedArrangements[0]):
          #print('True')
          copy = currentCombination.copy()
          copy.append((currentIndex,damagedArrangements[0]))
          self.determineCombinations(combinations, copy, currentIndex + damagedArrangements[0] + 1, damagedArrangements[1:])
    return combinations

  #def getTotal          
  def determineAllCombinations(self):
    return self.determineCombinations([], [], 0, self.damagedArrangements)

count = 0
combinationAt1XCounts = []
for l in current_input_lines:
  row = Row(l) 
  combinations = row.determineAllCombinations()
  combinationAt1XCounts.append(len(combinations))
  print(str(len(combinations)) + '\t' + l)
  #print(combinations)
  count += len(combinations)
        
print('Combinations' + str(count))

# ??#?#?#??????#??? 9,5   x[6] 2x[61] 3x[638] 4x[6714] 5x[70755]
# .?#??????. 1,3  x[6] 2x[17] (5)  3x[147] (123) 4x[1441] (1423) 5x[14499] (14403)

DEBUG = False
if DEBUG:
  for i,l in current_input_lines:
    string = l + '\tx[' + str(combinationAt1XCounts[0]) + ']'
    for r in range(2,6):
      combinationCount = len(Row(l, r).determineAllCombinations())
      combinationMultiplier = len(combinationsAt2X) / combinationAt1XCounts[i]

      string += str(i) + 'x[' + str() + '] (' +')'
      
    print(string)
  exit()

count = 0
for i, l in enumerate(current_input_lines):
  rowAt2x = Row(l, 2) 
  combinationsAt2X = rowAt2x.determineAllCombinations()
  
  combinationMultiplier = len(combinationsAt2X) / combinationAt1XCounts[i]
  assumed5xCombinationCount = combinationAt1XCounts[i] * pow(combinationMultiplier,4)
  combinationCount = len(Row(l,5).determineAllCombinations())
  #combinationCount = 0
  #if not combinationMultiplier.is_integer(): 
  #  combinationCount =  len(Row(l,5).determineAllCombinations())
  #else:
  #  combinationCount = assumed5xCombinationCount

  print(l + '\tx[' + str(combinationAt1XCounts[i]) + '] 2x[' + str(len(combinationsAt2X)) + '] 5x[' + str(combinationCount) + ']' + '5xAssumed[' + str(assumed5xCombinationCount) + ']')  

  count += combinationCount
print('Combinations: ' + str(count))